var broadcaster,numOfBroadcasters=0,pastBroadcasters=[];$(document).ready(function(){function e(){$("#following").mouseover(function(){Twitch.api({method:"/streams/followed"},function(e,a){$("#following ul").empty();for(var t=0;t<a.streams.length;t++)$("#following ul").append("<li>"+a.streams[t].channel.display_name+"</li>")})}),Twitch.api({method:"user"},function(e,a){$("#user div a").append(a.display_name),null===a.logo?$("#user div a").before("<img src='img/user-logo.png' class='user-logo' alt='Stream Monster Default Twitch User Logo'>"):$("#user div a").before("<img src='"+a.logo+"' class='user-logo' alt='"+a.display_name+" Twitch User Logo'>")})}function a(e){var a={broadcasterName:e,shellP1:"<object type='application/x-shockwave-flash'  height='378' width='620' id='live_embed_player_flash' data='http://www.twitch.tv/widgets/live_embed_player.swf?channel=",shellP2:"' bgcolor='#000000'><param name='allowFullScreen' value='true' /><param name='allowNetworking' value='all' /><param name='movie' value='http://www.twitch.tv/widgets/live_embed_player.swf' /><param name='flashvars' value='hostname=www.twitch.tv&channel=",shellP3:"&auto_play=false&start_volume=25' /></object>",chatP1:"<iframe frameborder='0' scrolling='no' id='chat_embed' src='http://twitch.tv/chat/embed?channel=",chatP2:"'&amp;popout_chat=true'></iframe>"},t=a.shellP1+a.broadcasterName+a.shellP2+a.broadcasterName+a.shellP3,s=a.chatP1+a.broadcasterName+a.chatP2;if($(".stream-wrapper").append("<div id='"+a.broadcasterName+"' class='stream medium-12 columns' style='margin-bottom{30px}'><div class='stream-video'>"+t+"</div></div>"),$("#"+a.broadcasterName+" > .stream-video").fitVids(),$(".chat").addClass("hidden"),$(".chat-wrapper").append("<div class='chat' id='"+a.broadcasterName+"-chat'>"+s+"</div>"),$("#remove-stream").removeClass("hidden"),$("#remove-stream ul").append("<li>"+a.broadcasterName+"</li>"),$("#change-chat").removeClass("hidden"),$("#change-chat ul").append("<li>"+a.broadcasterName+"</li>"),$("#hide-chat").removeClass("hidden"),$("#set-grid").removeClass("hidden"),$("#set-list").removeClass("hidden"),$(".current-chat").removeClass("hidden"),$(".current-chat span").empty().append(a.broadcasterName),$(".message").empty().append("<span>New stream added:</span> <br><h1>"+a.broadcasterName+"</h1>"),$(".message").fadeIn("fast").delay(2e3).fadeOut("fast"),numOfBroadcasters++,$(".stream-intro").length&&($(".stream-intro").remove(),$(".chat-intro").remove()),pastBroadcasters.length>1){var r=$("#"+a.broadcasterName).offset().top-70;$("html, body").animate({scrollTop:r},"fast")}else $("html, body").animate({scrollTop:$(window).offset().top},"fast")}function t(e){var a=$("#"+e).attr("id");$("#"+a).remove(),$("#change-chat li:contains('"+a+"')").remove(),$("#remove-stream li:contains('"+a+"')").remove(),$("#"+a+"-chat").remove(),numOfBroadcasters--}function s(e){$(".chat").addClass("hidden"),$("#"+e+"-chat").removeClass("hidden"),$(".current-chat span").empty().append(e)}function r(){$(".chat-wrapper").hide().fadeOut(),$(".stream-wrapper").removeClass("medium-8").addClass("medium-12").css("padding","0 14%"),$("#hide-chat").addClass("hidden"),$("#reveal-chat").removeClass("hidden")}function o(){$(".chat-wrapper").show().fadeIn(),$(".stream-wrapper").removeClass("medium-12").addClass("medium-8").css("padding","0 0.9375em"),$("#reveal-chat").addClass("hidden"),$("#hide-chat").removeClass("hidden")}function i(){numOfBroadcasters%1==0?($(".stream").removeClass("medium-1 medium-2 medium-3 medium-4 medium-6 medium-12"),1===numOfBroadcasters||numOfBroadcasters>=2&&($(".stream").addClass("medium-6 columns").css("padding","0"),$(".stream").css("margin-bottom","0"))):alert("Looks like something broke. :(")}function n(){$(".stream").removeClass("medium-1 medium-2 medium-3 medium-4 medium-6").css("padding","0.9375em"),$(".stream").css("margin-bottom","30px")}window.CLIENT_ID="CLIENT_ID",$(function(){Twitch.init({clientId:CLIENT_ID},function(a,t){t.authenticated?($(".authenticated").removeClass("hidden"),e()):$(".not-authenticated").removeClass("hidden")}),$(".twitch-connect").click(function(){Twitch.login({scope:["user_read","channel_read"]})}),$("#logout").click(function(){Twitch.logout(),window.location=window.location.pathname}),$("#add-stream button").click(function(){var e=$("#add-stream input").val();0===e.length?alert("You gotta enter something!"):(pastBroadcasters.push(e),$("#add-stream input").val(""),a(e))}),$(".stream-wrapper a").click(function(e){e.preventDefault()}),$("#remove-stream").on("click","li",function(){t($(this).text())}),$("#change-chat").on("click","li",function(){var e=$(this).text();s(e)}),$("#hide-chat").on("click",function(){r()}),$("#reveal-chat").on("click",function(){o()}),$("#following").on("click","li",function(){var e=$(this).text();pastBroadcasters.push(e),a(e)}),$("#set-grid").on("click",function(){i()}),$("#set-list").on("click",function(){n()})})});